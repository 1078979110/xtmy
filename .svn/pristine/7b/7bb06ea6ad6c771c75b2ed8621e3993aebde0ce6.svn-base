<?php
namespace App\Admin\Controllers;
use Encore\Admin\Controllers\AdminController;
use Encore\Admin\Layout\Content;
use Encore\Admin\Widgets\Form;
use Encore\Admin\Facades\Admin;
use App\Salelist;
use Illuminate\Support\Facades\DB;
use App\Prints;
class SettingController extends AdminController{
    public function info(Content $content){
        $content->title('账号设置');
        $telephone = Admin::user()->username; 
        $info = Salelist::where('telephone',$telephone)->get()->toArray(true);
        if(empty($info)){
            $infos = DB::table('admin_users')->where('username', $telephone)->get()->toArray(true);
            $info = (array)$infos[0];
        }
        $curr_info = $info;
        $content->body(view('admin.setting.info',['info'=>$curr_info])->render());
        //$content->body($form);
        return $content;
    }
    
    public function selectPrint(Content $content){
        $content->title('打印订单');
        $templates_jxs = Prints::where('type',1)->get()->toArray(true);
        $templates_ywy = Prints::where('type',2)->get()->toArray(true);
        $id = request()->get('id');
        $content->body(view('admin.setting.print',['id'=>$id,'templatesjxs'=>$templates_jxs, 'templatesywy'=>$templates_ywy])->render());
        return $content;
    }
}